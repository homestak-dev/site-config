# Full 3-level nested PVE validation
# Proves recursive architecture scales beyond N=2
#
# Topology:
#   father -> root-pve (L1) -> leaf-pve (L2) -> test (L3)
---
schema_version: 1
name: n3-full
description: "3-level Root PVE + Leaf PVE + Test VM"

levels:
  - name: root-pve
    vm_preset: large
    vmid: 99011
    image: debian-13-pve
    post_scenario: pve-setup
    post_scenario_args:
      - "--local"
      - "--skip-preflight"

  - name: leaf-pve
    vm_preset: medium
    vmid: 99021
    image: debian-13-pve
    post_scenario: pve-setup
    post_scenario_args:
      - "--local"
      - "--skip-preflight"

  - name: test
    vm_preset: small
    vmid: 99031
    image: debian-12
    post_scenario: null

settings:
  verify_ssh: true
  cleanup_on_failure: true
  timeout_buffer: 60
